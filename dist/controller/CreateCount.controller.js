sap.ui.define(["./BaseController","sap/ui/core/UIComponent","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(t,e,o,n){function r(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const i=r(t);const s=i.extend("ICL.InventoryCount.controller.CreateCount",{onInit:function t(){i.prototype.onInit.call(this);const o=e.getRouterFor(this);o.getRoute("createCount").attachMatched(this._initialFunc,this)},onAfterRendering:function t(){this.searchFieldExpand("fromSF");this.searchFieldExpand("toSF")},_initialFunc:function t(e){const o=this.getCountsModel();this.initModelState(o);this.fetchItems(o);this.fetchLoactions(o);o.setProperty("/oMaintain/title",myComponent.i18n("createCount"));o.setProperty("/oFlags/headerNavBack",true)},initModelState:function t(e){e.setProperty("/oMaintain/createCount/tabKey","1");e.setProperty("/oMaintain/createCount/currStep","1");e.setProperty("/oFlags/iturSearch",false);e.setProperty("/oMaintain/createCount/newItems",[])},fetchItems:function t(e){void fetch("/mockData/itemsInCounts.JSON").then(t=>t.json()).then(t=>{e.setProperty("/oData/itemsToAdd",t)})},fetchLoactions:function t(e){e.setProperty("/oData/locations",[{key:"I01/I01"},{key:"I01/I02"},{key:"I01/I03"},{key:"I01/I04"},{key:"I01/I05"},{key:"I01/I06"},{key:"I01/I07"},{key:"I01/I08"}])},searchFieldExpand:function t(e){const o=this.getCountsModel();const n=this.getView().byId(e);n.attachBrowserEvent("focusin",()=>{const t=o.getProperty("/oFlags/iturSearch");if(!t){o.setProperty("/oMaintain/createCount/oldToSF",o.getProperty("/oMaintain/createCount/toSF")||"");o.setProperty("/oMaintain/createCount/oldFromSF",o.getProperty("/oMaintain/createCount/fromSF")||"")}o.setProperty("/oFlags/iturSearchFocus",e);o.setProperty("/oFlags/iturSearch",true)})},returnFromLocateSeacrh:function t(){const e=this.getCountsModel();e.setProperty("/oFlags/iturSearch",false);e.setProperty("/oMaintain/createCount/toSF",e.getProperty("/oMaintain/createCount/oldToSF"));e.setProperty("/oMaintain/createCount/fromSF",e.getProperty("/oMaintain/createCount/oldFromSF"))},acceptLocate:function t(e){const r=this.getCountsModel();r.setProperty("/oFlags/iturSearch",false);const i=r.getProperty("/oMaintain/createCount/fromSF");const s=r.getProperty("/oMaintain/createCount/toSF");const a=this.getView().byId("itemsToAdd"),c=a.getBinding("items"),u=[new o("storageLoc",n.BT,i,s)];if(!!i&&!!s)c.filter(u);else c.filter(null)},selectLocation:function t(e){const o=this.getCountsModel();const n=e.getSource().getBindingContext("CountsModel").getObject();const r=o.getProperty("/oFlags/iturSearchFocus");o.setProperty(`/oMaintain/createCount/${r}`,n.key);if(r==="fromSF")this.getView().byId("toSF").focus()},checkSelected:function t(e){const o=this.getCountsModel();if(!e.getParameter("selected")){const t=o.getProperty("/oData/itemsToAdd");const e=t.find(t=>t.selected);o.setProperty("/oFlags/itemsToAddSelected",!!e)}else{o.setProperty("/oFlags/itemsToAddSelected",true)}},checkDelete:function t(e){const o=this.getCountsModel();if(!e.getParameter("selected")){const t=o.getProperty("/oMaintain/createCount/newItems");const e=t.find(t=>t.deleteState);o.setProperty("/oFlags/itemsToDelete",!!e)}else{o.setProperty("/oFlags/itemsToDelete",true)}},addToList:function t(){const e=this.getCountsModel();const o=e.getProperty("/oData/itemsToAdd");const n=o.filter(t=>t.selected);e.setProperty("/oMaintain/createCount/newItems",n);e.setProperty("/oMaintain/createCount/tabKey","2")},removeFromList:function t(){const e=this.getCountsModel();const o=e.getProperty("/oMaintain/createCount/newItems");const n=o.filter(t=>!t.deleteState);e.setProperty("/oMaintain/createCount/newItems",n)},onCreateCount:function t(){const e=this.getCountsModel();e.setProperty("/oMaintain/createCount/currStep","2");e.setProperty("/oData/createdCount",{id:"1234567890"})},onStartCount:function t(e){const o=this.getCountsModel();const n=o.getProperty("/oData/createdCount");this.navToCount(e,n.id)}});return s});